import type { PrefabChild } from '../types/PrefabChild.js';
import { BinaryWriter } from '../BinaryWriter.js';
import { Prefab } from '../Prefab.js';
import { writeChildren } from './writeChildren.js';

describe('writeChildren()', () => {
  let prefabChildren: PrefabChild[];

  beforeEach(() => {
    prefabChildren = [
      { parentHash: 1337, prefab: new Prefab('Phantom_Guard') },
      { parentHash: 420, prefab: new Prefab('Phantom_Guard') },
      { parentHash: 69, prefab: new Prefab('Phantom_Guard') }
    ];
  });

  it('stores PrefabChildren in the given BinaryWriter', () => {
    const expectedData =
      '1000000000000000000000101001110010000000000000000000110110001110000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000111111100000000000000000000000001111111000000000000000000000000000000000000000000000000000000000000000000000000000000000000000010000000000000000000000011010010000000000000000000001101100011100000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000001111111000000000000000000000000011111110000000000000000000000000000000000000000000000000000000000000000000000000000000000000000100000000000000000000000001000101000000000000000000011011000111000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000011111110000000000000000000000000111111100000000000000000000000000000000000000000000000000000000000000000000000000000000000000000';

    const writer = new BinaryWriter();

    writeChildren(writer, prefabChildren, new Map());

    const data = writer.flush();

    expect(data).toStrictEqual(expectedData);
  });
});
